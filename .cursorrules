# Reglas de Cursor para AplicaciÃ³n Angular

## ğŸ¯ Objetivo General
Desarrollar una aplicaciÃ³n Angular moderna, mantenible y escalable siguiendo las mejores prÃ¡cticas y patrones de diseÃ±o establecidos.

## ğŸ“ Estructura del Proyecto

### OrganizaciÃ³n de Carpetas
```
src/
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ core/                    # Servicios singleton, guards, interceptors
â”‚   â”‚   â”œâ”€â”€ guards/
â”‚   â”‚   â”œâ”€â”€ interceptors/
â”‚   â”‚   â”œâ”€â”€ services/
â”‚   â”‚   â””â”€â”€ models/
â”‚   â”œâ”€â”€ shared/                  # Componentes, pipes, directivas reutilizables
â”‚   â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”œâ”€â”€ pipes/
â”‚   â”‚   â”œâ”€â”€ directives/
â”‚   â”‚   â””â”€â”€ utils/
â”‚   â”œâ”€â”€ features/                # MÃ³dulos de caracterÃ­sticas especÃ­ficas
â”‚   â”‚   â”œâ”€â”€ auth/
â”‚   â”‚   â”œâ”€â”€ dashboard/
â”‚   â”‚   â””â”€â”€ [feature-name]/
â”‚   â”œâ”€â”€ layout/                  # Componentes de estructura (header, sidebar, footer)
â”‚   â””â”€â”€ app.component.*
â”œâ”€â”€ assets/
â”‚   â”œâ”€â”€ images/
â”‚   â”œâ”€â”€ icons/
â”‚   â””â”€â”€ styles/
â””â”€â”€ environments/
```

## ğŸ—ï¸ Arquitectura y Patrones

### Principios de DiseÃ±o
- **SeparaciÃ³n de Responsabilidades**: Cada componente/servicio tiene una responsabilidad Ãºnica
- **InyecciÃ³n de Dependencias**: Usar DI para servicios y configuraciÃ³n
- **Lazy Loading**: Implementar carga diferida para mÃ³dulos grandes
- **OnPush Change Detection**: Usar estrategia OnPush para mejor rendimiento
- **Reactive Programming**: Preferir RxJS sobre callbacks tradicionales

### Patrones de Componentes
```typescript
// Estructura estÃ¡ndar de componente
@Component({
  selector: 'app-feature-name',
  templateUrl: './feature-name.component.html',
  styleUrls: ['./feature-name.component.scss'],
  changeDetection: ChangeDetectionStrategy.OnPush
})
export class FeatureNameComponent implements OnInit, OnDestroy {
  // Properties
  private destroy$ = new Subject<void>();
  
  // Constructor con DI
  constructor(
    private service: FeatureService,
    private store: Store
  ) {}
  
  // Lifecycle hooks
  ngOnInit(): void {
    // InicializaciÃ³n
  }
  
  ngOnDestroy(): void {
    this.destroy$.next();
    this.destroy$.complete();
  }
}
```

## ğŸ¨ Estilos y UI/UX

### Framework de UI
- **Angular Material**: Componentes base del sistema de diseÃ±o
- **Tailwind CSS**: Utilidades CSS para estilos personalizados
- **SCSS**: Variables, mixins y funciones para consistencia

### Variables de DiseÃ±o
```scss
// _variables.scss
:root {
  // Colores
  --primary-color: #1976d2;
  --success-color: #4caf50;
  --warning-color: #ff9800;
  --error-color: #f44336;
  
  // TipografÃ­a
  --font-family: 'Roboto', sans-serif;
  --font-size-base: 16px;
  --line-height-base: 1.5;
  
  // Espaciado
  --spacing-xs: 0.25rem;
  --spacing-sm: 0.5rem;
  --spacing-md: 1rem;
  --spacing-lg: 1.5rem;
  --spacing-xl: 2rem;
  
  // Breakpoints
  --breakpoint-sm: 576px;
  --breakpoint-md: 768px;
  --breakpoint-lg: 992px;
  --breakpoint-xl: 1200px;
}
```

## ğŸ”§ ConfiguraciÃ³n y Herramientas

### ESLint y Prettier
```json
{
  "extends": [
    "@angular-eslint/recommended",
    "@angular-eslint/template/recommended"
  ],
  "rules": {
    "@angular-eslint/component-selector": [
      "error",
      {
        "type": "element",
        "prefix": "app",
        "style": "kebab-case"
      }
    ],
    "@angular-eslint/directive-selector": [
      "error",
      {
        "type": "attribute",
        "prefix": "app",
        "style": "camelCase"
      }
    ]
  }
}
```

### Husky y Git Hooks
- Pre-commit: Linting y formateo automÃ¡tico
- Pre-push: Tests unitarios y e2e
- Commit message: Convenciones de Conventional Commits

## ğŸ“Š Estado y GestiÃ³n de Datos

### NgRx Store (Para aplicaciones complejas)
```typescript
// Estructura del store
interface AppState {
  auth: AuthState;
  user: UserState;
  [feature]: FeatureState;
}

// Actions
export const featureActions = createActionGroup({
  source: 'Feature',
  events: {
    'Load Items': emptyProps(),
    'Load Items Success': props<{ items: Item[] }>(),
    'Load Items Failure': props<{ error: string }>()
  }
});

// Reducers
export const featureReducer = createReducer(
  initialState,
  on(featureActions.loadItems, state => ({ ...state, loading: true })),
  on(featureActions.loadItemsSuccess, (state, { items }) => ({ 
    ...state, 
    items, 
    loading: false 
  }))
);
```

### Servicios con RxJS
```typescript
@Injectable({
  providedIn: 'root'
})
export class DataService {
  private apiUrl = environment.apiUrl;
  
  constructor(private http: HttpClient) {}
  
  getItems(): Observable<Item[]> {
    return this.http.get<Item[]>(`${this.apiUrl}/items`).pipe(
      retry(3),
      catchError(this.handleError)
    );
  }
  
  private handleError(error: HttpErrorResponse): Observable<never> {
    console.error('An error occurred:', error);
    return throwError(() => new Error('Something went wrong'));
  }
}
```

## ğŸ§ª Testing

### Testing Unitario
```typescript
describe('FeatureComponent', () => {
  let component: FeatureComponent;
  let fixture: ComponentFixture<FeatureComponent>;
  let service: jasmine.SpyObj<FeatureService>;

  beforeEach(async () => {
    const spy = jasmine.createSpyObj('FeatureService', ['getData']);
    
    await TestBed.configureTestingModule({
      declarations: [FeatureComponent],
      providers: [
        { provide: FeatureService, useValue: spy }
      ]
    }).compileComponents();
    
    service = TestBed.inject(FeatureService) as jasmine.SpyObj<FeatureService>;
  });

  it('should create', () => {
    expect(component).toBeTruthy();
  });
});
```

### Testing E2E con Playwright
```typescript
import { test, expect } from '@playwright/test';

test('should display welcome message', async ({ page }) => {
  await page.goto('/');
  await expect(page.locator('h1')).toContainText('Welcome');
});
```

## ğŸš€ Performance y OptimizaciÃ³n

### Estrategias de Rendimiento
- **Lazy Loading**: Cargar mÃ³dulos bajo demanda
- **Preloading**: Precargar mÃ³dulos crÃ­ticos
- **Virtual Scrolling**: Para listas grandes
- **TrackBy Functions**: Optimizar ngFor
- **OnPush Change Detection**: Reducir ciclos de detecciÃ³n

### Bundle Optimization
```typescript
// angular.json
{
  "projects": {
    "app": {
      "architect": {
        "build": {
          "configurations": {
            "production": {
              "optimization": true,
              "outputHashing": "all",
              "sourceMap": false,
              "namedChunks": false,
              "aot": true,
              "extractLicenses": true,
              "vendorChunk": false,
              "buildOptimizer": true
            }
          }
        }
      }
    }
  }
}
```

## ğŸ”’ Seguridad

### Mejores PrÃ¡cticas
- **XSS Prevention**: Sanitizar inputs del usuario
- **CSRF Protection**: Tokens en requests
- **Content Security Policy**: Headers de seguridad
- **HTTPS Only**: En producciÃ³n
- **Input Validation**: ValidaciÃ³n tanto cliente como servidor

### Guards de AutenticaciÃ³n
```typescript
@Injectable({
  providedIn: 'root'
})
export class AuthGuard implements CanActivate {
  constructor(
    private authService: AuthService,
    private router: Router
  ) {}

  canActivate(): boolean {
    if (this.authService.isAuthenticated()) {
      return true;
    }
    
    this.router.navigate(['/login']);
    return false;
  }
}
```

## ğŸ“± Responsive Design

### Breakpoints y Media Queries
```scss
// Mobile First approach
.container {
  padding: var(--spacing-md);
  
  @media (min-width: 768px) {
    padding: var(--spacing-lg);
  }
  
  @media (min-width: 1024px) {
    padding: var(--spacing-xl);
  }
}
```

## ğŸŒ InternacionalizaciÃ³n

### i18n Setup
```typescript
// app.module.ts
import { HttpClient } from '@angular/common/http';
import { TranslateModule, TranslateLoader } from '@ngx-translate/core';
import { TranslateHttpLoader } from '@ngx-translate/http-loader';

export function HttpLoaderFactory(http: HttpClient) {
  return new TranslateHttpLoader(http, './assets/i18n/', '.json');
}

@NgModule({
  imports: [
    TranslateModule.forRoot({
      loader: {
        provide: TranslateLoader,
        useFactory: HttpLoaderFactory,
        deps: [HttpClient]
      },
      defaultLanguage: 'es'
    })
  ]
})
```

## ğŸ“ Convenciones de CÃ³digo

### Nomenclatura
- **Componentes**: `feature-name.component.ts`
- **Servicios**: `feature.service.ts`
- **Interfaces**: `feature.interface.ts`
- **Enums**: `feature.enum.ts`
- **Constants**: `feature.constants.ts`

### Imports Organizados
```typescript
// Angular imports
import { Component, OnInit } from '@angular/core';

// Third-party imports
import { Observable } from 'rxjs';

// Application imports
import { FeatureService } from './feature.service';
import { FeatureModel } from './models/feature.model';
```

## ğŸ”„ CI/CD

### Pipeline para Pull Requests (Solo Tests)
```yaml
# .github/workflows/pull-request.yml
name: Pull Request Checks

on:
  pull_request:
    branches: [main, develop]

jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v4
        
      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '18'
          cache: 'npm'
          
      - name: Install dependencies
        run: npm ci
        
      - name: Run linting
        run: npm run lint
        
      - name: Run unit tests
        run: npm test
        
      - name: Run e2e tests
        run: npm run e2e
        
      - name: Check bundle size
        run: npm run build:analyze
        
      - name: Upload test coverage
        uses: codecov/codecov-action@v3
        with:
          file: ./coverage/lcov.info
          flags: unittests
          name: codecov-umbrella
```

### Pipeline para Main Branch (Tests + Deploy)
```yaml
# .github/workflows/deploy-production.yml
name: Deploy to Production

on:
  push:
    branches: [main]

jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v4
        
      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '18'
          cache: 'npm'
          
      - name: Install dependencies
        run: npm ci
        
      - name: Run linting
        run: npm run lint
        
      - name: Run unit tests
        run: npm test
        
      - name: Run e2e tests
        run: npm run e2e
        
      - name: Build application
        run: npm run build:prod
        
      - name: Upload build artifacts
        uses: actions/upload-artifact@v3
        with:
          name: dist-files
          path: dist/
          
      - name: Upload test coverage
        uses: codecov/codecov-action@v3
        with:
          file: ./coverage/lcov.info
          flags: unittests
          name: codecov-umbrella

  security-scan:
    runs-on: ubuntu-latest
    needs: test
    steps:
      - name: Checkout code
        uses: actions/checkout@v4
        
      - name: Run security audit
        run: npm audit --audit-level=moderate
        
      - name: Run dependency check
        run: npm audit --audit-level=high

  deploy-staging:
    runs-on: ubuntu-latest
    needs: [test, security-scan]
    environment: staging
    steps:
      - name: Download build artifacts
        uses: actions/download-artifact@v3
        with:
          name: dist-files
          path: dist/
          
      - name: Deploy to staging
        run: |
          echo "Deploying to staging environment..."
          # AquÃ­ irÃ­an los comandos especÃ­ficos para tu plataforma
          # Ejemplo para Vercel:
          # npx vercel --prod --token ${{ secrets.VERCEL_TOKEN }}
          
      - name: Run smoke tests
        run: |
          echo "Running smoke tests on staging..."
          # Tests bÃ¡sicos para verificar que el deploy funcionÃ³

  deploy-production:
    runs-on: ubuntu-latest
    needs: deploy-staging
    environment: production
    if: github.ref == 'refs/heads/main'
    steps:
      - name: Download build artifacts
        uses: actions/download-artifact@v3
        with:
          name: dist-files
          path: dist/
          
      - name: Deploy to production
        run: |
          echo "Deploying to production environment..."
          # AquÃ­ irÃ­an los comandos especÃ­ficos para tu plataforma
          # Ejemplo para Vercel:
          # npx vercel --prod --token ${{ secrets.VERCEL_TOKEN }}
          
      - name: Notify deployment
        run: |
          echo "Production deployment completed successfully!"
          # AquÃ­ podrÃ­as agregar notificaciones a Slack, Discord, etc.
```

### ConfiguraciÃ³n de Environments
```yaml
# .github/environments/staging.yml
name: staging
url: https://staging.yourapp.com

# .github/environments/production.yml
name: production
url: https://yourapp.com
```

### Scripts de Package.json
```json
{
  "scripts": {
    "build:prod": "ng build --configuration production",
    "build:analyze": "ng build --stats-json && npx webpack-bundle-analyzer dist/stats.json",
    "test:ci": "ng test --watch=false --code-coverage",
    "e2e:ci": "ng e2e --configuration ci",
    "lint": "ng lint",
    "lint:fix": "ng lint --fix"
  }
}
```

## ğŸ“š DocumentaciÃ³n

### README.md Estructura
```markdown
# Â¿DeberÃ­as Desplegar Hoy?

## ğŸ¯ DescripciÃ³n
Una aplicaciÃ³n web inteligente que responde a la pregunta que todo desarrollador se hace mentalmente: **"Â¿Es conveniente hacer un deploy ahora?"**

La aplicaciÃ³n analiza el dÃ­a de la semana, la hora y la zona horaria para dar una respuesta contextual y divertida sobre si es el momento adecuado para desplegar tu aplicaciÃ³n.

## ğŸŒ CaracterÃ­sticas Principales

### ğŸ“… AnÃ¡lisis Temporal Inteligente
- **DetecciÃ³n automÃ¡tica de ubicaciÃ³n**: Identifica el paÃ­s y zona horaria del visitante
- **SelecciÃ³n manual**: Permite al usuario elegir paÃ­s/zona horaria e idioma
- **Respuestas contextuales**: 
  - ğŸŸ¢ **Lunes por la maÃ±ana**: "Â¡SÃ! Es el mejor momento del mundo para desplegar"
  - ğŸŸ¡ **MiÃ©rcoles**: "Hmm... podrÃ­a ser, pero ten cuidado"
  - ğŸ”´ **Viernes por la tarde**: "Â¡ABSOLUTAMENTE NO! Â¿EstÃ¡s loco?"
  - ğŸŒ™ **Fines de semana**: "Â¿En serio? Â¿Un fin de semana?"

### ğŸ² Frases Aleatorias y Personalizadas
- **Base de frases pre-generadas** para cada contexto temporal
- **PersonalizaciÃ³n por paÃ­s**: AdaptaciÃ³n al estilo de hablar de cada regiÃ³n
- **Tono humorÃ­stico**: Respuestas divertidas pero Ãºtiles
- **MÃºltiples idiomas**: Soporte para espaÃ±ol, inglÃ©s, portuguÃ©s, etc.

### ğŸ¨ Interfaz Intuitiva
- **DiseÃ±o minimalista**: Enfoque en la respuesta principal
- **Animaciones suaves**: Transiciones elegantes entre estados
- **Responsive**: Funciona perfectamente en mÃ³vil y desktop
- **Modo oscuro/claro**: AdaptaciÃ³n a preferencias del usuario

## ğŸš€ TecnologÃ­as
- **Angular 17+**: Framework principal con las Ãºltimas caracterÃ­sticas
- **TypeScript**: Tipado estÃ¡tico para mayor robustez
- **Angular Material**: Componentes UI consistentes y accesibles
- **Tailwind CSS**: Estilos utilitarios y responsive
- **NgRx**: GestiÃ³n de estado para funcionalidades avanzadas
- **i18n**: InternacionalizaciÃ³n completa
- **GeolocalizaciÃ³n**: DetecciÃ³n automÃ¡tica de ubicaciÃ³n
- **PWA**: Capacidades de aplicaciÃ³n web progresiva

## ğŸ“± Funcionalidades

### DetecciÃ³n AutomÃ¡tica
- GeolocalizaciÃ³n por IP
- DetecciÃ³n de zona horaria del navegador
- IdentificaciÃ³n del idioma preferido

### PersonalizaciÃ³n
- Selector de paÃ­s/regiÃ³n
- Selector de zona horaria
- Selector de idioma
- Modo de respuesta (conservador/divertido)

### Respuestas Contextuales
- **Lunes 9:00 AM**: "Â¡SÃ! Es lunes, todo el mundo estÃ¡ fresco y listo para arreglar bugs"
- **Lunes 3:00 PM**: "Â¡Adelante! ApÃºrate que se acaba el dÃ­a"
- **Lunes 5:00 PM**: "SÃ­, pero ese despliegue podrÃ­a esperar un dÃ­a mÃ¡s, Â¿no crees?"
- **Lunes 7:00 PM**: "Â¡NO! Ya es hora de cenar, maÃ±ana serÃ¡ otro dÃ­a"
- **MiÃ©rcoles 9:00 AM**: "Â¡SÃ! Tienes tiempo, despliega"
- **MiÃ©rcoles 4:00 PM**: "PodrÃ­a ser... pero Â¿ya probaste todo en staging?"
- **MiÃ©rcoles 6:30 PM**: "Â¡NO! La jornada laboral terminÃ³, descansa"
- **Jueves 9:00 AM**: "Hmm... Â¿estÃ¡s seguro? AÃºn tienes tiempo para pensarlo"
- **Jueves 3:00 PM**: "Mejor espera al lunes, Â¿no?"
- **Jueves 7:00 PM**: "Â¡NO! Es tarde, maÃ±ana serÃ¡ mejor"
- **Viernes 9:00 AM**: "Tal vez... Es viernes, ya probaste lo suficiente. Â¿QuÃ© tal el lunes?"
- **Viernes 1:00 PM**: "Â¡NO! Es viernes, nadie quiere trabajar el fin de semana"
- **Viernes 5:00 PM**: "Â¡ABSOLUTAMENTE NO! Â¿EstÃ¡s loco? Es viernes a las 5 PM"
- **Viernes 6:00 PM**: "Â¡NO! Ya es fin de semana, Â¡disfruta!"
- **SÃ¡bado 2:00 AM**: "Â¿EstÃ¡s despierto a las 2 AM? Mejor duerme y despliega maÃ±ana"
- **Domingo 11:00 AM**: "Â¿En serio? Â¿Un domingo? Disfruta tu dÃ­a libre"

## ğŸ¯ Casos de Uso
- **Desarrolladores indecisos**: "Â¿Deploy ahora o espero?"
- **Equipos de desarrollo**: DiscusiÃ³n sobre timing de deploys
- **DevOps**: EvaluaciÃ³n rÃ¡pida de riesgos temporales
- **Momentos de humor**: Alivio en momentos de estrÃ©s del desarrollo

## ğŸ› ï¸ InstalaciÃ³n
```bash
# Clonar el repositorio
git clone https://github.com/lumialvarez/deberia-desplegar-hoy.git

# Instalar dependencias
npm install

# Configurar variables de entorno
cp .env.example .env
```

## ğŸš€ Desarrollo
```bash
# Servidor de desarrollo
npm start

# Build de desarrollo
npm run build:dev

# AnÃ¡lisis de bundle
npm run build:analyze
```

## ğŸ—ï¸ Build y Deploy
```bash
# Build de producciÃ³n
npm run build:prod

# Preview del build
npm run preview

# Deploy automÃ¡tico (via CI/CD)
git push origin main
```

## ğŸ§ª Testing
```bash
# Tests unitarios
npm test

# Tests e2e
npm run e2e

# Coverage report
npm run test:coverage
```

## ğŸŒ ConfiguraciÃ³n de Idiomas
La aplicaciÃ³n soporta mÃºltiples idiomas con frases adaptadas a cada cultura:

### EspaÃ±ol (EspaÃ±a)
- "Â¡Venga ya! Es lunes por la maÃ±ana, Â¡despliega sin miedo!"

### EspaÃ±ol (MÃ©xico)
- "Â¡Ã“rale! Es lunes temprano, Â¡Ã©chale ganas al deploy!"

### EspaÃ±ol (Argentina)
- "Â¡Che! Es lunes a la maÃ±ana, Â¡mandale mecha al deploy!"

### InglÃ©s (US)
- "Hell yeah! It's Monday morning, time to deploy!"

### PortuguÃ©s (Brasil)
- "Valeu! Ã‰ segunda de manhÃ£, hora de fazer deploy!"

## ğŸ“Š MÃ©tricas y Analytics
- Tiempo de respuesta de la aplicaciÃ³n
- Frases mÃ¡s populares por regiÃ³n
- Horarios mÃ¡s consultados
- Idiomas mÃ¡s utilizados

## ğŸ¤ Contribuir
Â¿Tienes frases divertidas para tu paÃ­s? Â¡Contribuye!

1. Fork el proyecto
2. Agrega frases en tu idioma/regiÃ³n
3. Crea un Pull Request
4. Â¡Mantengamos el humor global!

## ğŸ“„ Licencia
MIT License - Â¡SiÃ©ntete libre de usar y modificar!

## ğŸ™ Agradecimientos
A todos los desarrolladores que alguna vez se preguntaron: "Â¿DeberÃ­a desplegar hoy?"
```

## ğŸ¯ Metas de Calidad

### MÃ©tricas Objetivo
- **Lighthouse Score**: >90 en todas las categorÃ­as
- **Bundle Size**: <500KB inicial
- **First Contentful Paint**: <1.5s
- **Time to Interactive**: <3.5s
- **Test Coverage**: >80%

### Monitoreo
- **Error Tracking**: Sentry o similar
- **Performance Monitoring**: Google Analytics, Web Vitals
- **User Analytics**: Hotjar, Google Analytics

---

## ğŸ’¡ Consejos Adicionales

1. **MantÃ©n el cÃ³digo simple**: Evita over-engineering
2. **Documenta decisiones importantes**: ADRs (Architecture Decision Records)
3. **Code Reviews**: Siempre revisa el cÃ³digo antes de merge
4. **Refactoring continuo**: Mejora el cÃ³digo constantemente
5. **MantÃ©n dependencias actualizadas**: npm audit regularmente
6. **Usa TypeScript strict mode**: Para mejor type safety
7. **Implementa error boundaries**: Para manejo de errores robusto
8. **Optimiza imÃ¡genes**: WebP, lazy loading, responsive images 